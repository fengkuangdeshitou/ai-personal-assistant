{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{useChat}from'../api';import'./Chat.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Chat=()=>{const{messages,isLoading,error,sendMessage,clearHistory}=useChat();const[inputMessage,setInputMessage]=useState('');const messagesEndRef=useRef(null);// Ëá™Âä®ÊªöÂä®Âà∞Â∫ïÈÉ®\nconst scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};useEffect(()=>{scrollToBottom();},[messages]);// ÂèëÈÄÅÊ∂àÊÅØÂ§ÑÁêÜ\nconst handleSendMessage=async e=>{e.preventDefault();if(!inputMessage.trim()||isLoading)return;const messageToSend=inputMessage.trim();setInputMessage('');await sendMessage(messageToSend);};// Ê∏ÖÁ©∫ÂéÜÂè≤Â§ÑÁêÜ\nconst handleClearHistory=async()=>{if(window.confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâËÅäÂ§©ËÆ∞ÂΩïÂêóÔºü')){await clearHistory();}};// Ê†ºÂºèÂåñÊó∂Èó¥\nconst formatTime=timestamp=>{return new Date(timestamp).toLocaleTimeString('zh-CN',{hour:'2-digit',minute:'2-digit'});};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDCAC AI \\u5BF9\\u8BDD\"}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-subtitle\",children:\"\\u4E0EAI\\u52A9\\u624B\\u667A\\u80FD\\u5BF9\\u8BDD\"}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-actions\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleClearHistory,className:\"clear-btn\",disabled:isLoading,children:\"\\uD83D\\uDDD1\\uFE0F \\u6E05\\u7A7A\\u5386\\u53F2\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-messages\",children:[messages.length===0&&!isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDCAD\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u5F00\\u59CB\\u4E0EAI\\u52A9\\u624B\\u5BF9\\u8BDD\\u5427\\uFF01\"})]}),messages.map(message=>/*#__PURE__*/_jsxs(\"div\",{className:\"message \".concat(message.role==='user'?'user-message':'ai-message'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-avatar\",children:message.role==='user'?'üë§':'ü§ñ'}),/*#__PURE__*/_jsxs(\"div\",{className:\"message-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-text\",children:message.content}),/*#__PURE__*/_jsx(\"div\",{className:\"message-time\",children:formatTime(message.timestamp)})]})]},message.id)),isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"message ai-message loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-avatar\",children:\"\\uD83E\\uDD16\"}),/*#__PURE__*/_jsx(\"div\",{className:\"message-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"typing-indicator\",children:[/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{})]})})]}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[\"\\u274C \",error]}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSendMessage,className:\"chat-input-form\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:inputMessage,onChange:e=>setInputMessage(e.target.value),placeholder:\"\\u8F93\\u5165\\u60A8\\u7684\\u95EE\\u9898...\",disabled:isLoading,className:\"message-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!inputMessage.trim()||isLoading,className:\"send-btn\",children:isLoading?'‚è≥':'üì§'})]})})]});};export default Chat;","map":{"version":3,"names":["React","useState","useRef","useEffect","useChat","jsx","_jsx","jsxs","_jsxs","Chat","messages","isLoading","error","sendMessage","clearHistory","inputMessage","setInputMessage","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","handleSendMessage","e","preventDefault","trim","messageToSend","handleClearHistory","window","confirm","formatTime","timestamp","Date","toLocaleTimeString","hour","minute","className","children","onClick","disabled","length","map","message","concat","role","content","id","ref","onSubmit","type","value","onChange","target","placeholder"],"sources":["/Users/maiyou001/.ai-assistant/gui/frontend/src/pages/Chat.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { useChat } from '../api';\nimport './Chat.css';\n\nconst Chat: React.FC = () => {\n  const { messages, isLoading, error, sendMessage, clearHistory } = useChat();\n  const [inputMessage, setInputMessage] = useState('');\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  // Ëá™Âä®ÊªöÂä®Âà∞Â∫ïÈÉ®\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // ÂèëÈÄÅÊ∂àÊÅØÂ§ÑÁêÜ\n  const handleSendMessage = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!inputMessage.trim() || isLoading) return;\n\n    const messageToSend = inputMessage.trim();\n    setInputMessage('');\n    await sendMessage(messageToSend);\n  };\n\n  // Ê∏ÖÁ©∫ÂéÜÂè≤Â§ÑÁêÜ\n  const handleClearHistory = async () => {\n    if (window.confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâËÅäÂ§©ËÆ∞ÂΩïÂêóÔºü')) {\n      await clearHistory();\n    }\n  };\n\n  // Ê†ºÂºèÂåñÊó∂Èó¥\n  const formatTime = (timestamp: string) => {\n    return new Date(timestamp).toLocaleTimeString('zh-CN', {\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  return (\n    <div className=\"chat-container\">\n      <div className=\"chat-header\">\n        <h1>üí¨ AI ÂØπËØù</h1>\n        <div className=\"chat-subtitle\">‰∏éAIÂä©ÊâãÊô∫ËÉΩÂØπËØù</div>\n        <div className=\"chat-actions\">\n          <button\n            onClick={handleClearHistory}\n            className=\"clear-btn\"\n            disabled={isLoading}\n          >\n            üóëÔ∏è Ê∏ÖÁ©∫ÂéÜÂè≤\n          </button>\n        </div>\n      </div>\n\n      <div className=\"chat-messages\">\n        {messages.length === 0 && !isLoading && (\n          <div className=\"empty-state\">\n            <div className=\"empty-icon\">üí≠</div>\n            <p>ÂºÄÂßã‰∏éAIÂä©ÊâãÂØπËØùÂêßÔºÅ</p>\n          </div>\n        )}\n\n        {messages.map((message) => (\n          <div\n            key={message.id}\n            className={`message ${message.role === 'user' ? 'user-message' : 'ai-message'}`}\n          >\n            <div className=\"message-avatar\">\n              {message.role === 'user' ? 'üë§' : 'ü§ñ'}\n            </div>\n            <div className=\"message-content\">\n              <div className=\"message-text\">{message.content}</div>\n              <div className=\"message-time\">{formatTime(message.timestamp)}</div>\n            </div>\n          </div>\n        ))}\n\n        {isLoading && (\n          <div className=\"message ai-message loading\">\n            <div className=\"message-avatar\">ü§ñ</div>\n            <div className=\"message-content\">\n              <div className=\"typing-indicator\">\n                <span></span>\n                <span></span>\n                <span></span>\n              </div>\n            </div>\n          </div>\n        )}\n\n        <div ref={messagesEndRef} />\n      </div>\n\n      {error && (\n        <div className=\"error-message\">\n          ‚ùå {error}\n        </div>\n      )}\n\n      <form onSubmit={handleSendMessage} className=\"chat-input-form\">\n        <div className=\"input-container\">\n          <input\n            type=\"text\"\n            value={inputMessage}\n            onChange={(e) => setInputMessage(e.target.value)}\n            placeholder=\"ËæìÂÖ•ÊÇ®ÁöÑÈóÆÈ¢ò...\"\n            disabled={isLoading}\n            className=\"message-input\"\n          />\n          <button\n            type=\"submit\"\n            disabled={!inputMessage.trim() || isLoading}\n            className=\"send-btn\"\n          >\n            {isLoading ? '‚è≥' : 'üì§'}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default Chat;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}