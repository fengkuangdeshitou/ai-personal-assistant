{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useState, useEffect, useCallback } from 'react';\nimport { chatApi, projectApi } from './client';\n// 聊天Hook\nexport const useChat = () => {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // 发送消息\n  const sendMessage = useCallback(async (message, model = 'gpt-3.5-turbo') => {\n    if (!message.trim()) {\n      setError('消息不能为空');\n      return;\n    }\n    setIsLoading(true);\n    setError(null);\n    try {\n      const request = {\n        message: message.trim(),\n        model\n      };\n      const response = await chatApi.sendMessage(request);\n      if (response.success && response.history) {\n        setMessages(response.history);\n      } else {\n        setError(response.error || '发送消息失败');\n      }\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error('Send message error:', err);\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || err.message || '网络错误');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // 清空历史\n  const clearHistory = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const response = await chatApi.clearHistory();\n      if (response.success) {\n        setMessages([]);\n      } else {\n        setError(response.error || '清空历史失败');\n      }\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      console.error('Clear history error:', err);\n      setError(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.error) || err.message || '网络错误');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // 加载历史\n  const loadHistory = useCallback(async (limit = 50) => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const response = await chatApi.getHistory(limit);\n      if (response.success && response.history) {\n        setMessages(response.history);\n      } else {\n        setError(response.error || '加载历史失败');\n      }\n    } catch (err) {\n      var _err$response3, _err$response3$data;\n      console.error('Load history error:', err);\n      setError(((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.error) || err.message || '网络错误');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // 组件挂载时加载历史\n  useEffect(() => {\n    loadHistory();\n  }, [loadHistory]);\n  return {\n    messages,\n    isLoading,\n    error,\n    sendMessage,\n    clearHistory,\n    loadHistory\n  };\n};\n\n// 项目管理Hook\n_s(useChat, \"Pkzg8Aa/83LIDjfJLpCYAYYSeDM=\");\nexport const useProjects = () => {\n  _s2();\n  const [projects, setProjects] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const loadProjects = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const response = await projectApi.getProjects();\n      if (response.success) {\n        setProjects(response.message || []);\n      } else {\n        setError(response.error || '加载项目失败');\n      }\n    } catch (err) {\n      var _err$response4, _err$response4$data;\n      console.error('Load projects error:', err);\n      setError(((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.error) || err.message || '网络错误');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n  const scanProjects = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const response = await projectApi.scanProjects();\n      if (response.success) {\n        await loadProjects(); // 重新加载项目列表\n      } else {\n        setError(response.error || '扫描项目失败');\n      }\n    } catch (err) {\n      var _err$response5, _err$response5$data;\n      console.error('Scan projects error:', err);\n      setError(((_err$response5 = err.response) === null || _err$response5 === void 0 ? void 0 : (_err$response5$data = _err$response5.data) === null || _err$response5$data === void 0 ? void 0 : _err$response5$data.error) || err.message || '网络错误');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [loadProjects]);\n  useEffect(() => {\n    loadProjects();\n  }, [loadProjects]);\n  return {\n    projects,\n    isLoading,\n    error,\n    loadProjects,\n    scanProjects\n  };\n};\n_s2(useProjects, \"sN8ufEoiUVnRLbDZ5JnYPcoegfM=\");","map":{"version":3,"names":["useState","useEffect","useCallback","chatApi","projectApi","useChat","_s","messages","setMessages","isLoading","setIsLoading","error","setError","sendMessage","message","model","trim","request","response","success","history","err","_err$response","_err$response$data","console","data","clearHistory","_err$response2","_err$response2$data","loadHistory","limit","getHistory","_err$response3","_err$response3$data","useProjects","_s2","projects","setProjects","loadProjects","getProjects","_err$response4","_err$response4$data","scanProjects","_err$response5","_err$response5$data"],"sources":["/Users/maiyou001/.ai-assistant/gui/frontend/src/api/hooks.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport { chatApi, projectApi, ChatMessage, SendMessageRequest, ApiResponse } from './client';\n\nexport interface UseChatReturn {\n  messages: ChatMessage[];\n  isLoading: boolean;\n  error: string | null;\n  sendMessage: (message: string, model?: string) => Promise<void>;\n  clearHistory: () => Promise<void>;\n  loadHistory: (limit?: number) => Promise<void>;\n}\n\n// 聊天Hook\nexport const useChat = (): UseChatReturn => {\n  const [messages, setMessages] = useState<ChatMessage[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // 发送消息\n  const sendMessage = useCallback(async (message: string, model = 'gpt-3.5-turbo') => {\n    if (!message.trim()) {\n      setError('消息不能为空');\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const request: SendMessageRequest = { message: message.trim(), model };\n      const response: ApiResponse<ChatMessage> = await chatApi.sendMessage(request);\n\n      if (response.success && response.history) {\n        setMessages(response.history);\n      } else {\n        setError(response.error || '发送消息失败');\n      }\n    } catch (err: any) {\n      console.error('Send message error:', err);\n      setError(err.response?.data?.error || err.message || '网络错误');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // 清空历史\n  const clearHistory = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const response: ApiResponse = await chatApi.clearHistory();\n      if (response.success) {\n        setMessages([]);\n      } else {\n        setError(response.error || '清空历史失败');\n      }\n    } catch (err: any) {\n      console.error('Clear history error:', err);\n      setError(err.response?.data?.error || err.message || '网络错误');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // 加载历史\n  const loadHistory = useCallback(async (limit = 50) => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const response: ApiResponse<ChatMessage[]> = await chatApi.getHistory(limit);\n      if (response.success && response.history) {\n        setMessages(response.history);\n      } else {\n        setError(response.error || '加载历史失败');\n      }\n    } catch (err: any) {\n      console.error('Load history error:', err);\n      setError(err.response?.data?.error || err.message || '网络错误');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // 组件挂载时加载历史\n  useEffect(() => {\n    loadHistory();\n  }, [loadHistory]);\n\n  return {\n    messages,\n    isLoading,\n    error,\n    sendMessage,\n    clearHistory,\n    loadHistory,\n  };\n};\n\n// 项目管理Hook\nexport const useProjects = () => {\n  const [projects, setProjects] = useState<any[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const loadProjects = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const response = await projectApi.getProjects();\n      if (response.success) {\n        setProjects(response.message || []);\n      } else {\n        setError(response.error || '加载项目失败');\n      }\n    } catch (err: any) {\n      console.error('Load projects error:', err);\n      setError(err.response?.data?.error || err.message || '网络错误');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const scanProjects = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const response = await projectApi.scanProjects();\n      if (response.success) {\n        await loadProjects(); // 重新加载项目列表\n      } else {\n        setError(response.error || '扫描项目失败');\n      }\n    } catch (err: any) {\n      console.error('Scan projects error:', err);\n      setError(err.response?.data?.error || err.message || '网络错误');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [loadProjects]);\n\n  useEffect(() => {\n    loadProjects();\n  }, [loadProjects]);\n\n  return {\n    projects,\n    isLoading,\n    error,\n    loadProjects,\n    scanProjects,\n  };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}