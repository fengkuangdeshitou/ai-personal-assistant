#!/bin/bash

# 🧪 自动确认功能演示
# ===================

# 加载自动确认函数
source ~/.ai-assistant/scripts/auto_confirm.sh

echo "🕐 AI 助理自动确认功能演示"
echo "========================="
echo ""

echo "📋 功能说明："
echo "   • 所有需要用户确认的操作现在都有5秒倒计时"
echo "   • 倒计时期间可以手动选择，或等待自动确认"
echo "   • 提高了自动化程度，减少等待时间"
echo ""

# 演示1: 基本确认
echo "🎯 演示1: 基本自动确认"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"

if auto_confirm "是否要继续演示？" 5 "y"; then
    echo "✅ 您选择了继续"
else
    echo "❌ 您选择了取消"
    exit 0
fi

echo ""

# 演示2: 多选确认
echo "🎯 演示2: 多选自动确认"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"

auto_select "请选择一个操作:" "查看项目状态" "创建新项目" "备份项目" "检查环境" 5 1
selected_option=$?

case $selected_option in
    0) echo "✅ 您选择了: 查看项目状态" ;;
    1) echo "✅ 您选择了: 创建新项目" ;;
    2) echo "✅ 您选择了: 备份项目" ;;
    3) echo "✅ 您选择了: 检查环境" ;;
esac

echo ""

# 演示3: 智能等待
echo "🎯 演示3: 智能等待进度条"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"

smart_wait "正在初始化 AI 助理功能..." 3

echo ""

# 演示4: 实际应用场景
echo "🎯 演示4: 实际应用场景"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"

echo "💡 在以下场景中会自动使用倒计时确认："
echo ""
echo "🔐 权限配置:"
echo "   权限设置 → 自动确认应用新权限配置"
echo ""
echo "📦 项目备份:"
echo "   备份项目 → 自动选择备份模式"
echo "           → 自动确认压缩选项"  
echo ""
echo "🚀 项目创建:"
echo "   新建项目 → 自动确认在 VS Code 中打开"
echo ""
echo "⚠️  危险操作:"
echo "   删除项目 → 5秒倒计时，默认取消"
echo ""

if auto_confirm "是否现在就体验这些功能？" 5 "y"; then
    echo ""
    echo "🎉 太好了！您可以使用以下命令体验："
    echo ""
    echo "   权限设置     # 体验权限配置的自动确认"
    echo "   备份项目     # 体验备份的自动选择"
    echo "   新建项目     # 体验项目创建的自动确认"
    echo ""
    echo "💡 在倒计时过程中，您随时可以："
    echo "   • 按 'y' 立即确认"
    echo "   • 按 'n' 立即取消"  
    echo "   • 等待自动选择默认选项"
else
    echo ""
    echo "📚 没关系，您可以随时使用这些功能！"
fi

echo ""
echo "🎊 自动确认功能演示完成！"
echo ""
echo "🌟 特色功能："
echo "   ✅ 5秒智能倒计时"
echo "   ✅ 可中断手动选择"
echo "   ✅ 智能默认选项"
echo "   ✅ 进度可视化"
echo "   ✅ 提升自动化体验"